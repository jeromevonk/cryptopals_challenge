#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// Common for cryptopals
#include "util.h"
#include "crypto_util.h"

unsigned char aucPlaintext[74] = {
   0x42, 0x75, 0x72, 0x6E, 0x69, 0x6E, 0x67, 0x20, 0x27, 0x65, 0x6D, 0x2C,
   0x20, 0x69, 0x66, 0x20, 0x79, 0x6F, 0x75, 0x20, 0x61, 0x69, 0x6E, 0x27,
   0x74, 0x20, 0x71, 0x75, 0x69, 0x63, 0x6B, 0x20, 0x61, 0x6E, 0x64, 0x20,
   0x6E, 0x69, 0x6D, 0x62, 0x6C, 0x65, 0x0A, 0x49, 0x20, 0x67, 0x6F, 0x20,
   0x63, 0x72, 0x61, 0x7A, 0x79, 0x20, 0x77, 0x68, 0x65, 0x6E, 0x20, 0x49,
   0x20, 0x68, 0x65, 0x61, 0x72, 0x20, 0x61, 0x20, 0x63, 0x79, 0x6D, 0x62,
   0x61, 0x6C
};

unsigned char aucKey[3] = { 'I', 'C', 'E' };

int main()
{
   printf("|- - - - - - - - - - - - - - -\n");
   printf("|      Repeating-key XOR      |\n");
   printf("|- - - - - - - - - - - - - - -\n");

   Block ciphertext(sizeof(aucPlaintext));

   XOR_encrypt(aucPlaintext, sizeof(aucPlaintext), aucKey, sizeof(aucKey), ciphertext.data);

   PrintToConsole(ciphertext.data, ciphertext.len, false, true);

   pause();

   return 0;
}