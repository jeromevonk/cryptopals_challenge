#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// Common for cryptopals
#include "util.h"
#include "crypto_util.h"

unsigned char ucToEncode[96] = {
   0x34, 0x39, 0x32, 0x37, 0x36, 0x64, 0x32, 0x30, 0x36, 0x62, 0x36, 0x39,
   0x36, 0x63, 0x36, 0x63, 0x36, 0x39, 0x36, 0x65, 0x36, 0x37, 0x32, 0x30,
   0x37, 0x39, 0x36, 0x66, 0x37, 0x35, 0x37, 0x32, 0x32, 0x30, 0x36, 0x32,
   0x37, 0x32, 0x36, 0x31, 0x36, 0x39, 0x36, 0x65, 0x32, 0x30, 0x36, 0x63,
   0x36, 0x39, 0x36, 0x62, 0x36, 0x35, 0x32, 0x30, 0x36, 0x31, 0x32, 0x30,
   0x37, 0x30, 0x36, 0x66, 0x36, 0x39, 0x37, 0x33, 0x36, 0x66, 0x36, 0x65,
   0x36, 0x66, 0x37, 0x35, 0x37, 0x33, 0x32, 0x30, 0x36, 0x64, 0x37, 0x35,
   0x37, 0x33, 0x36, 0x38, 0x37, 0x32, 0x36, 0x66, 0x36, 0x66, 0x36, 0x64
};


int main()
{
   printf("|- - - - - - - - - - - - - - - - \n");
   printf("|           Base64 encode        |\n");
   printf("|- - - - - - - - - - - - - - - - \n");

   // First, hex encode the bytes
   Block hex_data = String_to_Hex(ucToEncode, sizeof(ucToEncode));

   // Base64 encode
   Block encoded = base64encode(hex_data.data, hex_data.len);

   // Print to screen
   printf("Base64 encoded string is:\n");
   PrintToConsole(encoded.data, encoded.len);

   pause();
   
   return 0;
}